{"version":3,"sources":["/Users/kevin/Dev/OpenSource/react/react-native-event/src/index.ts"],"sourcesContent":["import type { ReactNode } from 'react';\nimport { createContext, createElement, useContext, useEffect, useState } from 'react';\nimport type { GestureResponderEvent } from 'react-native';\nimport { StyleSheet, View } from 'react-native';\n\nexport type EventTypes = GestureResponderEvent;\nexport type HandlerType = (event: EventTypes) => void;\n\nexport type EventContextType = {\n  subscribe: (handler: HandlerType) => void;\n};\n\nexport const EventContext = createContext<EventContextType | undefined>(undefined);\n\nexport type EventProviderProps = {\n  events?: string[];\n  children?: ReactNode;\n};\nexport function EventProvider({ children }: EventProviderProps) {\n  const state = useState<HandlerType[]>([]);\n  const handlers = state[0];\n\n  function onEvent(event: EventTypes) {\n    handlers.forEach((subscriber) => subscriber(event));\n  }\n  function subscribe(handler: HandlerType) {\n    handlers.push(handler);\n    return () => handlers.splice(handlers.indexOf(handler), 1);\n  }\n\n  return createElement(\n    EventContext.Provider,\n    { value: { subscribe } },\n    createElement(\n      View,\n      {\n        style: StyleSheet.absoluteFill,\n        onStartShouldSetResponderCapture: (event) => {\n          event.persist();\n          onEvent(event);\n          return false;\n        },\n      },\n      children\n    )\n  );\n}\n\nexport function useEvent(handler: HandlerType, dependencies: unknown[]) {\n  const context = useContext(EventContext);\n  if (!context) {\n    throw new Error('react-native-event: subscribe not found on context. You might be missing the EventProvider or have multiple instances of react-native-event');\n  }\n\n  useEffect(() => context.subscribe(handler), [context.subscribe, handler, ...dependencies]);\n}\n"],"names":["EventContext","EventProvider","useEvent","createContext","undefined","children","state","useState","handlers","onEvent","event","forEach","subscriber","subscribe","handler","push","splice","indexOf","createElement","Provider","value","View","style","StyleSheet","absoluteFill","onStartShouldSetResponderCapture","persist","dependencies","context","useContext","Error","useEffect"],"mappings":";;;;;;;;;;;QAYaA;eAAAA;;QAMGC;eAAAA;;QA8BAC;eAAAA;;;qBA/C8D;2BAE7C;;;;;;;;;;;;;;;;;;;;;;;;;;AAS1B,IAAMF,eAAeG,IAAAA,oBAAa,EAA+BC;AAMjE,SAASH,cAAc,KAAgC;QAAhC,AAAEI,WAAF,MAAEA;IAC9B,IAAMC,QAAQC,IAAAA,eAAQ,EAAgB,EAAE;IACxC,IAAMC,WAAWF,KAAK,CAAC,EAAE;IAEzB,SAASG,QAAQC,KAAiB;QAChCF,SAASG,OAAO,CAAC,SAACC;mBAAeA,WAAWF;;IAC9C;IACA,SAASG,UAAUC,OAAoB;QACrCN,SAASO,IAAI,CAACD;QACd,OAAO;mBAAMN,SAASQ,MAAM,CAACR,SAASS,OAAO,CAACH,UAAU;;IAC1D;IAEA,OAAOI,IAAAA,oBAAa,EAClBlB,aAAamB,QAAQ,EACrB;QAAEC,OAAO;YAAEP,WAAAA;QAAU;IAAE,GACvBK,IAAAA,oBAAa,EACXG,iBAAI,EACJ;QACEC,OAAOC,uBAAU,CAACC,YAAY;QAC9BC,kCAAkC,SAACf;YACjCA,MAAMgB,OAAO;YACbjB,QAAQC;YACR,OAAO;QACT;IACF,GACAL;AAGN;AAEO,SAASH,SAASY,OAAoB,EAAEa,YAAuB;IACpE,IAAMC,UAAUC,IAAAA,iBAAU,EAAC7B;IAC3B,IAAI,CAAC4B,SAAS;QACZ,MAAM,IAAIE,MAAM;IAClB;IAEAC,IAAAA,gBAAS,EAAC;eAAMH,QAAQf,SAAS,CAACC;OAAU;QAACc,QAAQf,SAAS;QAAEC;KAAyB,CAA7C,OAA6B,qBAAGa;AAC9E"}